<!doctype html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Charles Troupin</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content=" ">
    <meta name="keywords" content="data analyst, engineering, oceanography, ocean science, numerical modelling" />
    <meta name="author" content="Troupin Charles">
    <link rel="canonical" href="http://localhost:4000/posts/2019-09-01-geotiff-pcolor/">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">

    <!-- Custom CSS & Bootstrap Core CSS - Uses Bootswatch Flatly Theme: http://bootswatch.com/flatly/ -->
    <link rel="stylesheet" href="/style.css">

    <!-- Google verification -->
    

    <!-- Bing Verification -->
    

    <!-- Custom Fonts
    <link rel="stylesheet" href="/assets/css/font-awesome/css/fontawesome.css">
    <link rel="stylesheet" href="/assets/css/font-awesome/css/fontawesome-all.css">
    <link rel="stylesheet" href="/assets/css/font-awesome/css/fa-brands.css">
    <link rel="stylesheet" href="/assets/css/font-awesome/css/fa-regular.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/regular.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css">
    <link rel="stylesheet" href="/assets/css/academicons.css">
    <link href="//fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>


<html lang="en-US">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<title>Charles Troupin by </title>

	<link rel="stylesheet" href="/assets/css/style.css?v=">

	<meta name="viewport" content="width=device-width">
	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

</head>

<body>

	<div class="container">
		<div class="col-lg-8 col-lg-offset-2">
			<center>
				<h2> Displaying a 2D field over a visible image in Python </h2>
			</center>
			<blogsection>
				 <div style="text-align:left; vertical-align: middle; ">
					
						<h4><i class="far fa-calendar-alt"></i></h4> 01 September 2019 &nbsp;
					
					
						<h4><i class="fas fa-wrench"></i></h4> Python, Basemap, Cartopy &nbsp;
					
					
						<h4><i class="fas fa-tags"></i></h4> Oceanography, Maps &nbsp;
					
					
				</div>
				<p>The goal is to show how to plot geophysical fields using for instance <code class="language-plaintext highlighter-rouge">pcolor</code>, over a background consisting of a visible, satellite image, using</p>
<ol>
  <li><a href="https://matplotlib.org/basemap/"><code class="language-plaintext highlighter-rouge">Basemap</code></a>.</li>
  <li><a href="https://scitools.org.uk/cartopy/docs/latest/"><code class="language-plaintext highlighter-rouge">Cartopy</code></a>.
The data file is not provided but (hopefully) the procedure is clear enough that it can be with any dataset.</li>
</ol>

<p>You can download the <a href="https://ctroupin.github.io/notebooks/python/plot_visible_pcolor.ipynb">full notebook</a>.</p>

<p><img src="http://localhost:4000/figures/blog/chl_oc3_V22.png" class="img-responsive" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="kn">import</span> <span class="n">os</span>
<span class="kn">from</span> <span class="n">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">Basemap</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">cartopy</span>
<span class="kn">import</span> <span class="n">cartopy.crs</span> <span class="k">as</span> <span class="n">ccrs</span>
<span class="kn">import</span> <span class="n">cartopy.feature</span> <span class="k">as</span> <span class="n">cf</span>
<span class="kn">import</span> <span class="n">netCDF4</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.colors</span> <span class="k">as</span> <span class="n">colors</span>
<span class="kn">import</span> <span class="n">cmocean</span>
<span class="kn">from</span> <span class="n">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span><span class="p">,</span> <span class="n">osr</span>
<span class="kn">from</span> <span class="n">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
</code></pre></div></div>

<p>These lines to get rid of some <code class="language-plaintext highlighter-rouge">Matplotlib</code> warnings:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="kn">import</span> <span class="n">warnings</span>
<span class="kn">import</span> <span class="n">matplotlib.cbook</span>
<span class="n">warnings</span><span class="p">.</span><span class="nf">filterwarnings</span><span class="p">(</span><span class="sh">"</span><span class="s">ignore</span><span class="sh">"</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="n">matplotlib</span><span class="p">.</span><span class="n">cbook</span><span class="p">.</span><span class="n">mplDeprecation</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="data">Data</h2>
<p>We will use:</p>
<ol>
  <li>Sentinel-2 image (geoTIFF format) downloaded from the <a href="https://apps.sentinel-hub.com/eo-browser/?lat=57.991&amp;lng=18.620&amp;zoom=9&amp;time=2019-08-09&amp;preset=1_TRUE_COLOR&amp;atmFilter=DOS1&amp;datasource=Sentinel-2%20L2A">Sentinel-Hub</a> browser and</li>
  <li>A netCDF file containg measurements of chlorophyll concentration, also Sentinel-2.</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">imagefile</span> <span class="o">=</span> <span class="sh">"</span><span class="s">/data/Visible/Sentinel-2_L2A_2019-08-09c.tiff</span><span class="sh">"</span>
<span class="n">datafile</span> <span class="o">=</span> <span class="sh">"</span><span class="s">/data/Sentinel2/S2A_MSI_2019_08_09_10_00_31_T34VCK_L2W.nc</span><span class="sh">"</span>
<span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">exists</span><span class="p">(</span><span class="n">imagefile</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">exists</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="trac"><code>True
</code></pre></div></div>

<h3 id="data-reading">Data reading</h3>
<p>For the netCDF we load the coordinates and the field:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="k">with</span> <span class="n">netCDF4</span><span class="p">.</span><span class="nc">Dataset</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span> <span class="k">as</span> <span class="n">nc</span><span class="p">:</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="n">nc</span><span class="p">.</span><span class="n">variables</span><span class="p">[</span><span class="sh">"</span><span class="s">lon</span><span class="sh">"</span><span class="p">][:]</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">nc</span><span class="p">.</span><span class="n">variables</span><span class="p">[</span><span class="sh">"</span><span class="s">lat</span><span class="sh">"</span><span class="p">][:]</span>
    <span class="n">chl_oc3</span> <span class="o">=</span> <span class="n">nc</span><span class="p">.</span><span class="n">variables</span><span class="p">[</span><span class="sh">"</span><span class="s">chl_oc3</span><span class="sh">"</span><span class="p">][:]</span>
</code></pre></div></div>

<h3 id="visible-image-reading">Visible image reading</h3>
<p>The image was downloaded as a high-resolution geoTIFF with the WGS 84 coordinate system. <br />
The function to read the file is detailed in this <a href="https://ctroupin.github.io/posts/2019-08-30-basemap_geotiff/">post</a>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="k">def</span> <span class="nf">read_geotiff</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    Read an image and compute the coordinates from a geoTIFF file
    </span><span class="sh">"""</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">gdal</span><span class="p">.</span><span class="nc">Open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">gdal</span><span class="p">.</span><span class="n">GA_ReadOnly</span><span class="p">)</span>
    <span class="n">ds</span><span class="p">.</span><span class="nc">GetProjectionRef</span><span class="p">()</span>
    <span class="c1"># Read the array and the transformation
</span>    <span class="n">arr</span> <span class="o">=</span> <span class="n">ds</span><span class="p">.</span><span class="nc">ReadAsArray</span><span class="p">()</span>
    <span class="n">trans</span> <span class="o">=</span> <span class="n">ds</span><span class="p">.</span><span class="nc">GetGeoTransform</span><span class="p">()</span>
    <span class="n">extent</span> <span class="o">=</span> <span class="p">(</span><span class="n">trans</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ds</span><span class="p">.</span><span class="n">RasterXSize</span><span class="o">*</span><span class="n">trans</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">trans</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">ds</span><span class="p">.</span><span class="n">RasterYSize</span><span class="o">*</span><span class="n">trans</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">trans</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

    <span class="c1"># Get the info on the projection
</span>    <span class="n">proj</span> <span class="o">=</span> <span class="n">ds</span><span class="p">.</span><span class="nc">GetProjection</span><span class="p">()</span>
    <span class="n">inproj</span> <span class="o">=</span> <span class="n">osr</span><span class="p">.</span><span class="nc">SpatialReference</span><span class="p">()</span>
    <span class="n">inproj</span><span class="p">.</span><span class="nc">ImportFromWkt</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span>

    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">transpose</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ds</span><span class="p">.</span><span class="n">RasterXSize</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ds</span><span class="p">.</span><span class="n">RasterYSize</span><span class="p">)</span>

    <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">lon</span> <span class="o">=</span> <span class="n">trans</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">xx</span> <span class="o">+</span> <span class="n">trans</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">yy</span> <span class="o">+</span> <span class="n">trans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">trans</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="n">xx</span> <span class="o">+</span> <span class="n">trans</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="n">yy</span> <span class="o">+</span> <span class="n">trans</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">extent</span><span class="p">,</span> <span class="n">inproj</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">lon_vis</span><span class="p">,</span> <span class="n">lat_vis</span><span class="p">,</span> <span class="n">image_vis</span><span class="p">,</span> <span class="n">extent</span><span class="p">,</span> <span class="n">inproj</span> <span class="o">=</span> <span class="nf">read_geotiff</span><span class="p">(</span><span class="n">imagefile</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">inproj</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="trac"><code>GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4326"]]
</code></pre></div></div>

<p>The variable <code class="language-plaintext highlighter-rouge">extent</code> stores the image geographical domain:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="nf">print</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="trac"><code>(16.182861328125004, 21.305236816406254, 57.5290963291026, 58.91599192355906)
</code></pre></div></div>

<h2 id="create-the-plot">Create the plot</h2>
<h3 id="projection">Projection</h3>
<p>With <code class="language-plaintext highlighter-rouge">Basemap</code> we start by creating the projection.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">m</span> <span class="o">=</span> <span class="nc">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="sh">'</span><span class="s">merc</span><span class="sh">'</span><span class="p">,</span>
        <span class="n">llcrnrlon</span><span class="o">=</span><span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">llcrnrlat</span><span class="o">=</span><span class="n">extent</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="n">urcrnrlon</span><span class="o">=</span><span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">urcrnrlat</span><span class="o">=</span><span class="n">extent</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="n">lat_ts</span><span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">extent</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">extent</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">),</span> <span class="n">resolution</span><span class="o">=</span><span class="sh">"</span><span class="s">h</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="test-1">Test 1</h3>
<p>For the tests, it is better to sub-sample the field to display, this is why we add the <code class="language-plaintext highlighter-rouge">[::NN, ::NN]</code> after the variables.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">NN</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="c1"># Add the visible image
</span><span class="n">m</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">image_vis</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="sh">'</span><span class="s">upper</span><span class="sh">'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">pcm</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="nf">pcolormesh</span><span class="p">(</span><span class="n">lon</span><span class="p">[::</span><span class="n">NN</span><span class="p">,</span> <span class="p">::</span><span class="n">NN</span><span class="p">],</span> <span class="n">lat</span><span class="p">[::</span><span class="n">NN</span><span class="p">,</span> <span class="p">::</span><span class="n">NN</span><span class="p">],</span> <span class="n">chl_oc3</span><span class="p">[::</span><span class="n">NN</span><span class="p">,</span> <span class="p">::</span><span class="n">NN</span><span class="p">],</span> <span class="n">latlon</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
           <span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="p">.</span><span class="nc">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">7.5</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">ice</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">pcm</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="sh">"</span><span class="s">both</span><span class="sh">"</span><span class="p">)</span>
<span class="n">cb</span><span class="p">.</span><span class="nf">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">cb</span><span class="p">.</span><span class="nf">set_ticklabels</span><span class="p">([</span><span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">3</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">5</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">6</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">7</span><span class="sh">"</span><span class="p">])</span>

<span class="n">m</span><span class="p">.</span><span class="nf">drawcoastlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">.3</span><span class="sh">"</span><span class="p">)</span>
<span class="n">m</span><span class="p">.</span><span class="nf">drawmeridians</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mf">17.25</span><span class="p">,</span> <span class="mf">19.55</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="n">labels</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="p">.</span><span class="mi">25</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">m</span><span class="p">.</span><span class="nf">drawparallels</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mf">57.5</span><span class="p">,</span> <span class="mf">59.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="n">labels</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="p">.</span><span class="mi">25</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="http://localhost:4000/figures/blog/geotiff_pcolor/output_16_1.png" class="img-responsive" /></p>

<h3 id="test-2">Test 2</h3>
<p>It is not too bad but the limits are taken from the visible image, while we might prefer to use the field (chlorophyll concentration) extent. Here is the new projection:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">m2</span> <span class="o">=</span> <span class="nc">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="sh">'</span><span class="s">merc</span><span class="sh">'</span><span class="p">,</span>
        <span class="n">llcrnrlon</span><span class="o">=</span><span class="n">lon</span><span class="p">.</span><span class="nf">min</span><span class="p">(),</span> <span class="n">llcrnrlat</span><span class="o">=</span><span class="n">lat</span><span class="p">.</span><span class="nf">min</span><span class="p">(),</span>
        <span class="n">urcrnrlon</span><span class="o">=</span><span class="n">lon</span><span class="p">.</span><span class="nf">max</span><span class="p">(),</span> <span class="n">urcrnrlat</span><span class="o">=</span><span class="n">lat</span><span class="p">.</span><span class="nf">max</span><span class="p">(),</span>
        <span class="n">lat_ts</span><span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">lat</span><span class="p">.</span><span class="nf">min</span><span class="p">()</span> <span class="o">+</span> <span class="n">lat</span><span class="p">.</span><span class="nf">max</span><span class="p">()</span> <span class="p">),</span> <span class="n">resolution</span><span class="o">=</span><span class="sh">"</span><span class="s">h</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<p>If we apply the same plotting code as before, it won’t work correctly…</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">NN</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="c1"># Add the visible image
</span><span class="n">m2</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">image_vis</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="sh">'</span><span class="s">upper</span><span class="sh">'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">pcm</span> <span class="o">=</span> <span class="n">m2</span><span class="p">.</span><span class="nf">pcolormesh</span><span class="p">(</span><span class="n">lon</span><span class="p">[::</span><span class="n">NN</span><span class="p">,</span> <span class="p">::</span><span class="n">NN</span><span class="p">],</span> <span class="n">lat</span><span class="p">[::</span><span class="n">NN</span><span class="p">,</span> <span class="p">::</span><span class="n">NN</span><span class="p">],</span> <span class="n">chl_oc3</span><span class="p">[::</span><span class="n">NN</span><span class="p">,</span> <span class="p">::</span><span class="n">NN</span><span class="p">],</span> <span class="n">latlon</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
           <span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="p">.</span><span class="nc">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">7.5</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">ice</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">pcm</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="sh">"</span><span class="s">both</span><span class="sh">"</span><span class="p">)</span>
<span class="n">cb</span><span class="p">.</span><span class="nf">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">cb</span><span class="p">.</span><span class="nf">set_ticklabels</span><span class="p">([</span><span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">3</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">5</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">6</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">7</span><span class="sh">"</span><span class="p">])</span>

<span class="n">m2</span><span class="p">.</span><span class="nf">drawcoastlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">.3</span><span class="sh">"</span><span class="p">)</span>
<span class="n">m2</span><span class="p">.</span><span class="nf">drawmeridians</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mf">17.25</span><span class="p">,</span> <span class="mf">19.55</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="n">labels</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">m2</span><span class="p">.</span><span class="nf">drawparallels</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mf">57.5</span><span class="p">,</span> <span class="mf">59.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="n">labels</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="http://localhost:4000/figures/blog/geotiff_pcolor/output_20_1.png" class="img-responsive" /></p>

<p>It might look ok, but it is not: the visible background does not correspond to the field displayed with <code class="language-plaintext highlighter-rouge">pcolormesh</code> (you can check with the position of the clouds).</p>

<h3 id="test-3-subset-visible-image">Test 3: subset visible image</h3>
<p>We will take only the part of the visible image that corresponds to our domain, as defined by the chlorophyll field.   <br />
<strong>Note:</strong> this will work only if the visible image domain encompasses the field we want to plot over it.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">domain</span> <span class="o">=</span> <span class="p">(</span><span class="n">lon</span><span class="p">.</span><span class="nf">min</span><span class="p">(),</span> <span class="n">lon</span><span class="p">.</span><span class="nf">max</span><span class="p">(),</span> <span class="n">lat</span><span class="p">.</span><span class="nf">min</span><span class="p">(),</span> <span class="n">lat</span><span class="p">.</span><span class="nf">max</span><span class="p">())</span>
</code></pre></div></div>

<p>We create a short function for the extraction of a sub-domain of the geoTIFF.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="k">def</span> <span class="nf">extract_area</span><span class="p">(</span><span class="n">lonvis</span><span class="p">,</span> <span class="n">latvis</span><span class="p">,</span> <span class="n">arrayvis</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    Extract the visible image in the region of interest
    </span><span class="sh">"""</span>
    <span class="n">llon</span> <span class="o">=</span> <span class="n">lonvis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">llat</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">lats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">lats</span> <span class="ow">in</span> <span class="n">latvis</span><span class="p">])</span>
    <span class="n">goodlon</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span> <span class="p">(</span><span class="n">llon</span> <span class="o">&lt;=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">llon</span> <span class="o">&gt;=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">goodlat</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span> <span class="p">(</span><span class="n">llat</span> <span class="o">&lt;=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">llat</span> <span class="o">&gt;=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">2</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">arrayvis</span> <span class="o">=</span> <span class="n">arrayvis</span><span class="p">[</span><span class="n">goodlat</span><span class="p">,:,:]</span>
    <span class="n">arrayvis</span> <span class="o">=</span> <span class="n">arrayvis</span><span class="p">[:,</span><span class="n">goodlon</span><span class="p">,:]</span>

    <span class="k">return</span> <span class="n">arrayvis</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">image_sel</span> <span class="o">=</span> <span class="nf">extract_area</span><span class="p">(</span><span class="n">lon_vis</span><span class="p">,</span> <span class="n">lat_vis</span><span class="p">,</span> <span class="n">image_vis</span><span class="p">,</span> <span class="n">domain</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="create-the-plot-1">Create the plot</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">NN</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="c1"># Add the visible image
</span><span class="n">m2</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">image_sel</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="sh">'</span><span class="s">upper</span><span class="sh">'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">pcm</span> <span class="o">=</span> <span class="n">m2</span><span class="p">.</span><span class="nf">pcolormesh</span><span class="p">(</span><span class="n">lon</span><span class="p">[::</span><span class="n">NN</span><span class="p">,</span> <span class="p">::</span><span class="n">NN</span><span class="p">],</span> <span class="n">lat</span><span class="p">[::</span><span class="n">NN</span><span class="p">,</span> <span class="p">::</span><span class="n">NN</span><span class="p">],</span> <span class="n">chl_oc3</span><span class="p">[::</span><span class="n">NN</span><span class="p">,</span> <span class="p">::</span><span class="n">NN</span><span class="p">],</span> <span class="n">latlon</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
           <span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="p">.</span><span class="nc">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">7.5</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">ice</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">pcm</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="sh">"</span><span class="s">both</span><span class="sh">"</span><span class="p">)</span>
<span class="n">cb</span><span class="p">.</span><span class="nf">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">cb</span><span class="p">.</span><span class="nf">set_ticklabels</span><span class="p">([</span><span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">3</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">5</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">6</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">7</span><span class="sh">"</span><span class="p">])</span>

<span class="n">m2</span><span class="p">.</span><span class="nf">drawcoastlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">.3</span><span class="sh">"</span><span class="p">)</span>
<span class="n">m2</span><span class="p">.</span><span class="nf">drawmeridians</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mf">17.25</span><span class="p">,</span> <span class="mf">19.55</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="n">labels</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">m2</span><span class="p">.</span><span class="nf">drawparallels</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mf">57.5</span><span class="p">,</span> <span class="mf">59.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="n">labels</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">m2</span><span class="p">.</span><span class="nf">drawmapscale</span><span class="p">(</span><span class="mf">18.</span><span class="p">,</span> <span class="mf">57.7</span><span class="p">,</span> <span class="mf">18.</span><span class="p">,</span> <span class="mf">57.7</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="n">barstyle</span><span class="o">=</span><span class="sh">'</span><span class="s">simple</span><span class="sh">'</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="sh">'</span><span class="s">km</span><span class="sh">'</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">yoffset</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">labelstyle</span><span class="o">=</span><span class="sh">'</span><span class="s">simple</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontcolor</span><span class="o">=</span><span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="c1"># plt.savefig("./chl_oc3_V24.png", dpi=600, bbox_inches="tight")
</span><span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="http://localhost:4000/figures/blog/geotiff_pcolor/output_28_1.png" class="img-responsive" /></p>

<h2 id="cartopy">Cartopy</h2>
<p>The code is almost the same. We just have to use:</p>
<ul>
  <li>the arguments <em>extent</em> and <em>transform</em> in the <code class="language-plaintext highlighter-rouge">imshow()</code> call;</li>
  <li>the methods <code class="language-plaintext highlighter-rouge">set_xlim()</code> and <code class="language-plaintext highlighter-rouge">set_ylim()</code> to limit the domain.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">myproj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="p">.</span><span class="nc">Mercator</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">myproj</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">image_vis</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="sh">'</span><span class="s">upper</span><span class="sh">'</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">myproj</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="sh">'</span><span class="s">10m</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">0.8</span><span class="sh">"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">pcolormesh</span><span class="p">(</span><span class="n">lon</span><span class="p">[::</span><span class="n">NN</span><span class="p">,</span> <span class="p">::</span><span class="n">NN</span><span class="p">],</span> <span class="n">lat</span><span class="p">[::</span><span class="n">NN</span><span class="p">,</span> <span class="p">::</span><span class="n">NN</span><span class="p">],</span> <span class="n">chl_oc3</span><span class="p">[::</span><span class="n">NN</span><span class="p">,</span> <span class="p">::</span><span class="n">NN</span><span class="p">],</span>
               <span class="n">transform</span><span class="o">=</span><span class="n">myproj</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="p">.</span><span class="nc">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">7.5</span><span class="p">),</span>
               <span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">ice</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">gridlines</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">myproj</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">gl</span><span class="p">.</span><span class="n">xlabels_top</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">gl</span><span class="p">.</span><span class="n">ylabels_left</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">gl</span><span class="p">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
<span class="n">gl</span><span class="p">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="n">lon</span><span class="p">.</span><span class="nf">min</span><span class="p">(),</span> <span class="n">lon</span><span class="p">.</span><span class="nf">max</span><span class="p">())</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">(</span><span class="n">lat</span><span class="p">.</span><span class="nf">min</span><span class="p">(),</span> <span class="n">lat</span><span class="p">.</span><span class="nf">max</span><span class="p">())</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="http://localhost:4000/figures/blog/geotiff_pcolor/output_30_1.png" class="img-responsive" /></p>

<p>The projection is not exactly the same as with <code class="language-plaintext highlighter-rouge">Basemap</code>, but we’ll solve that later.</p>

			</blogsection>
		</div>
	</div>
</body>

</body>
</html>
