<!doctype html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Charles Troupin</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Turning ocean data into stories">
    <meta name="keywords" content="data analyst, engineering, oceanography, ocean science, numerical modelling" />
    <meta name="author" content="Troupin Charles">
    <link rel="canonical" href="https://ctroupin.github.io/posts/2021-04-17-cartopy-wms/">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">

    <!-- Custom CSS & Bootstrap Core CSS - Uses Bootswatch Flatly Theme: http://bootswatch.com/flatly/ -->
    <link rel="stylesheet" href="/style.css">

    <!-- Google verification -->
    

    <!-- Bing Verification -->
    

    <!-- Custom Fonts
    <link rel="stylesheet" href="/assets/css/font-awesome/css/fontawesome.css">
    <link rel="stylesheet" href="/assets/css/font-awesome/css/fontawesome-all.css">
    <link rel="stylesheet" href="/assets/css/font-awesome/css/fa-brands.css">
    <link rel="stylesheet" href="/assets/css/font-awesome/css/fa-regular.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/brands.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/regular.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/fontawesome.min.css">
    <link rel="stylesheet" href="/assets/css/academicons.css">
    <link href="//fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>


<html lang="en-US">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<title>Charles Troupin by </title>

	<link rel="stylesheet" href="/assets/css/style.css?v=">

	<meta name="viewport" content="width=device-width">
	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

</head>

<body>

	<div class="container">
		<div class="col-lg-8 col-lg-offset-2">
			<center>
				<h2> Adding WMS on a map with Python </h2>
			</center>
			<blogsection>
				 <div style="text-align:left; vertical-align: middle; ">
					
						<h4><i class="far fa-calendar-alt"></i></h4> 17 April 2021 &nbsp;
					
					
						<h4><i class="fas fa-wrench"></i></h4> Python, matplotlib, Cartopy, WMS &nbsp;
					
					
						<h4><i class="fas fa-tags"></i></h4> Data visualisation &nbsp;
					
					
				</div>
				<h2 id="the-beginning">The beginning</h2>

<p>The other day I was asked by a colleague to prepare high-resolution figures
using data from a project. She had prepared them by doing screenshots from
a web interface, but not only the resolution was not good enough, the
quality of the figure was not great.</p>

<p><img src="https://ctroupin.github.io/figures/blog/cartopy-wms/eut_cont.png" class="img-responsive" /></p>

<p>In this post we will see how we can do something nicer with a few lines of code.</p>

<h2 id="the-idea">The idea</h2>

<p>First of all: what do we want to get? According to the requirements:</p>
<ul>
  <li>resolution about 300 dpi (or more) → easy!</li>
  <li>aspect ratio of the plot: 1.78 approx. → not difficult, but need fine-tuning</li>
  <li>something that looks nice, with data points located on a map.</li>
</ul>

<p>My idea was to use the <a href="https://portal.emodnet-bathymetry.eu/">EMODnet Bathymetry</a> as the map background, so I directly have the depth and the coastline. Then on top of that, I will add the data points and the 2-dimensional field.</p>

<p>Instead of downloaded the bathymetry in netCDF, then plotting it with functions such as
<code class="highlighter-rouge">pcolor</code> or <code class="highlighter-rouge">contourf</code>, I thought that <a href="https://www.ogc.org/standards/wms"><code class="highlighter-rouge">WMS</code></a> (Web Map Service) could make things easier.
<code class="highlighter-rouge">WMS</code> is a protocol developed by the Open Geospatial Consortium and was designed to
request geo-registered images from geospatial databases.</p>

<p>The EMODnet bathymetry server can be reached at http://ows.emodnet-bathymetry.eu/wms
and the layers of interest are called ‘emodnet:mean_atlas_land’ and ‘coastlines’.</p>

<h2 id="the-tools-basemap-or-cartopy">The tools: Basemap or Cartopy?</h2>

<p>I’ve been writing about <code class="highlighter-rouge">Basemap</code> and <code class="highlighter-rouge">Cartopy</code> several times in this blog, for example
<a href="../2020-11-27-basemap-cartopy">here</a> and <a href="../2019-09-04-cartopy-julia">here</a>.
Even after quite a long time using it, I still try things first with <code class="highlighter-rouge">Basemap</code>, though I know
it is not developed anymore.   <br />
The thing is, when you need to update to something new (for example
going from Python to Julia), there is always some kind of inertia, or simply a lack of time
to spend on learning. Here there was a good reason to settle for <code class="highlighter-rouge">Cartopy</code>: I want to
use add WMS layer, and with <code class="highlighter-rouge">Basemap</code>, it is not so straightforward.</p>

<h3 id="first-try-with-basemap">First try with Basemap</h3>

<p>The method is described in the <a href="https://basemaptutorial.readthedocs.io/en/latest/backgrounds.html#wmsimage">Basemap doc</a>, in summary the call looks like:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">wmsimage</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span>
</code></pre></div></div>
<p>Using EMODnet Bathymetry WMS:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">lonmin</span><span class="p">,</span> <span class="n">lonmax</span><span class="p">,</span> <span class="n">latmin</span><span class="p">,</span> <span class="n">latmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">60.</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">llcrnrlat</span><span class="o">=</span><span class="n">latmin</span><span class="p">,</span> <span class="n">urcrnrlat</span><span class="o">=</span><span class="n">latmax</span><span class="p">,</span> <span class="n">llcrnrlon</span><span class="o">=</span><span class="n">lonmin</span><span class="p">,</span> <span class="n">urcrnrlon</span><span class="o">=</span><span class="n">lonmax</span><span class="p">,</span> <span class="n">lat_ts</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s">'i'</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="mi">3857</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">wmsimage</span><span class="p">(</span><span class="s">'http://ows.emodnet-bathymetry.eu/wms?'</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="s">'emodnet:mean_atlas_land'</span><span class="p">,</span> <span class="s">'coastlines'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p>we get something that looks good. Note that we have to well specify the <code class="highlighter-rouge">epsg</code> parameter,
otherwise we can end up with a blank plot without any error message.</p>

<p><img src="https://ctroupin.github.io/figures/blog/cartopy-wms/basemap-wms.jpg" class="img-responsive" /></p>

<p>So yes, it works with <code class="highlighter-rouge">Basemap</code>, now let’s check with <code class="highlighter-rouge">Cartopy</code> (I have to admit it did not
work when I start drafting this post, but then I was able to find a solution).</p>

<h3 id="cartopy">Cartopy</h3>

<p>I will provide more details here, as this is supposed to be the preferred solution.
First, let’s define the projection, here we want to use <em>Mercator</em>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="kn">import</span> <span class="nn">cartopy</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="n">ccrs</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">31.</span><span class="p">,</span> <span class="mf">23.</span><span class="p">,</span> <span class="mf">46.</span><span class="p">,</span> <span class="mi">64</span><span class="p">]</span>
<span class="n">myproj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">min_latitude</span><span class="o">=</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">max_latitude</span><span class="o">=</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">globe</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">latitude_true_scale</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div>
<p>Then we create a set of fake data points, within our domain of interest:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="kn">import</span>
<span class="nn">dlon</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">dlat</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="n">NN</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">lon</span> <span class="o">=</span> <span class="p">[</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="n">dlon</span> <span class="k">for</span> <span class="n">iii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">NN</span><span class="p">)]</span>
<span class="n">lat</span> <span class="o">=</span> <span class="p">[</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="n">dlat</span> <span class="k">for</span> <span class="n">iii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">NN</span><span class="p">)]</span>
<span class="n">field</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="n">dlat</span> <span class="k">for</span> <span class="n">iii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">NN</span><span class="p">)]</span>
</code></pre></div></div>
<p>Now we have all we need for a simple test:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">myproj</span><span class="p">)</span>
<span class="n">scat</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">field</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno_r</span><span class="p">,</span>
                  <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_wms</span><span class="p">(</span><span class="n">wms</span><span class="o">=</span><span class="s">'http://ows.emodnet-bathymetry.eu/wms'</span><span class="p">,</span>
               <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="s">'emodnet:mean_atlas_land'</span><span class="p">,</span> <span class="s">'coastlines'</span><span class="p">],</span>
               <span class="n">transform</span><span class="o">=</span><span class="n">myproj</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p>Yes it works! Now time to explain why it works.
<img src="https://ctroupin.github.io/figures/blog/cartopy-wms/cartopywms01.jpg" class="img-responsive" /></p>

<ul>
  <li>We specify which projection we want to use for the plot:    <br />
<code class="highlighter-rouge">ax = plt.axes(projection=myproj)</code></li>
  <li>We add a <code class="highlighter-rouge">transform=</code> optional arguments to the <code class="highlighter-rouge">scatter</code> function call.
According to the <a href="https://scitools.org.uk/cartopy/docs/latest/tutorials/understanding_transform.html">doc</a>, when the transform argument is not supplied, it means that the coordinate system matches the projection. If we try to remove <code class="highlighter-rouge">transform=</code>, we will get an error due to the coordinate change:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="o">...</span>
<span class="nb">ValueError</span><span class="p">:</span> <span class="n">zero</span><span class="o">-</span><span class="n">size</span> <span class="n">array</span> <span class="n">to</span> <span class="n">reduction</span> <span class="n">operation</span> <span class="n">maximum</span> <span class="n">which</span> <span class="n">has</span> <span class="n">no</span> <span class="n">identity</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>Another way to avoid the error would be to set the projection to <code class="highlighter-rouge">PlateCarree</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="n">data_crs</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">data_crs</span><span class="p">)</span>
<span class="n">scat</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">field</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno_r</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_wms</span><span class="p">(</span><span class="n">wms</span><span class="o">=</span><span class="s">'http://ows.emodnet-bathymetry.eu/wms'</span><span class="p">,</span>
               <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="s">'emodnet:mean_atlas_land'</span><span class="p">,</span> <span class="s">'coastlines'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://ctroupin.github.io/figures/blog/cartopy-wms/cartopywms02.jpg" class="img-responsive" />
The points are located at the same locations as the previous figure, but obviously the aspect ratio of the figure is different because of the projection.</p>

<p>So basically, the key is to understand the <code class="highlighter-rouge">transform=</code> option: it has to be used to
specify which projection is used for the object we want to plot, it can be the data or something
else.</p>

<h2 id="making-things-nicer">Making things nicer</h2>

<p>At the end we want something nice and clean, which can easily be done by adding a few lines of code to the basic example. What about adding?</p>
<ul>
  <li>a color bar?</li>
  <li>longitude and latitude labels?</li>
  <li>a grid?
and even better, using real data?</li>
</ul>

<p><img src="https://ctroupin.github.io/figures/blog/cartopy-wms/chlorophyll_v03.png" class="img-responsive" /></p>

<p>This is what had been done in this <a href="https://github.com/gher-ulg/EMODnet-Chemistry/blob/master/python/plot_observations_ingestion.ipynb">notebook</a>, though I will add the code here for completeness:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="trac"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">cartopy</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="n">ccrs</span>
<span class="kn">import</span> <span class="nn">netCDF4</span>
<span class="kn">import</span> <span class="nn">cmocean</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="k">as</span> <span class="n">gridliner</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="n">mticker</span>
<span class="kn">import</span> <span class="nn">cartopy.mpl.ticker</span> <span class="k">as</span> <span class="n">cartopyticker</span>

<span class="n">lon_formatter</span> <span class="o">=</span> <span class="n">cartopyticker</span><span class="o">.</span><span class="n">LongitudeFormatter</span><span class="p">()</span>
<span class="n">lat_formatter</span> <span class="o">=</span> <span class="n">cartopyticker</span><span class="o">.</span><span class="n">LatitudeFormatter</span><span class="p">()</span>
<span class="n">coordinates</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">31.</span><span class="p">,</span> <span class="mf">23.</span><span class="p">,</span> <span class="mf">46.</span><span class="p">,</span> <span class="mi">64</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">myproj</span><span class="p">)</span>

<span class="n">scat</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lon2</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">field2</span><span class="p">,</span>
                  <span class="n">vmin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">algae</span><span class="p">,</span>
                  <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s">"max"</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">"[mg/m$^3$]"</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">"left"</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=-</span><span class="mf">12.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_wms</span><span class="p">(</span><span class="n">wms</span><span class="o">=</span><span class="s">'http://ows.emodnet-bathymetry.eu/wms'</span><span class="p">,</span>
               <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="s">'emodnet:mean_atlas_land'</span><span class="p">,</span> <span class="s">'coastlines'</span><span class="p">],</span>
               <span class="n">transform</span><span class="o">=</span><span class="n">myproj</span><span class="p">)</span>

<span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">draw_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                  <span class="n">linewidth</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'gray'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'-'</span><span class="p">)</span>
<span class="n">gl</span><span class="o">.</span><span class="n">xlabels_top</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">gl</span><span class="o">.</span><span class="n">ylabels_right</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">30.</span><span class="p">,</span> <span class="mf">21.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">))</span>
<span class="n">gl</span><span class="o">.</span><span class="n">ylocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mf">61.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Water body chlorophyll-a"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

			</blogsection>
		</div>
	</div>
</body>

</body>
</html>
