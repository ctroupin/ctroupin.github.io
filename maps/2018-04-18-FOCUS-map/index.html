<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Charles Troupin</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Turning ocean data into stories">
    <meta name="keywords" content="data analyst, engineering, oceanography, ocean science, numerical modelling" />
    <meta name="author" content="Troupin Charles">
    <link rel="canonical" href="https://ctroupin.github.io/maps/2018-04-18-FOCUS-map/">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">

    <!-- Custom CSS & Bootstrap Core CSS - Uses Bootswatch Flatly Theme: http://bootswatch.com/flatly/ -->
    <link rel="stylesheet" href="/style.css">

    <!-- Google verification -->
    

    <!-- Bing Verification -->
    

    <!-- Custom Fonts
    <link rel="stylesheet" href="/assets/css/font-awesome/css/fontawesome.css">
    <link rel="stylesheet" href="/assets/css/font-awesome/css/fontawesome-all.css">
    <link rel="stylesheet" href="/assets/css/font-awesome/css/fa-brands.css">
    <link rel="stylesheet" href="/assets/css/font-awesome/css/fa-regular.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/brands.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/regular.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/fontawesome.min.css">
    <link rel="stylesheet" href="/assets/css/academicons.css">
    <link href="//fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>


<!-- Navigation -->
<nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ctroupin.github.io">Charles Troupin</a>
        </div>
    </div>
    <!-- /.container-fluid -->
</nav>

<!-- Header -->
<header>
    <div class="container">
        <h2>Maps</h2>
    </div>
</header>

<head>
    <meta charset="utf-8">

    <script src ="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.3/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.3/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.fullscreen/1.4.3/Control.FullScreen.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.3.0/MarkerCluster.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.3.0/MarkerCluster.Default.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet-groupedlayercontrol/0.6.1/leaflet.groupedlayercontrol.min.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/togeojson/0.16.0/togeojson.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.heat/0.2.0/leaflet-heat.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-omnivore/0.3.4/leaflet-omnivore.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.fullscreen/1.4.3/Control.FullScreen.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.0.6/leaflet.markercluster.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-groupedlayercontrol/0.6.1/leaflet.groupedlayercontrol.js"></script>
    <script type="text/javascript" src="/maps/js/Leaflet.Geodesic.js"></script>
    <script type="text/javascript" src="/maps/js/basemaps.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/4.4.8/css/ionicons.min.css">
    <style type="text/css">
      #map {
        width:100%;
        height:450px;
      }
      #map2points {
        width:100%;
        height:450px;
      }
      #mapfarthestairports {
        width:100%;
        height:450px;
      }
      .awesome-marker i {
          font-size: 18px;
          margin-top: 5px;
      }
      .info { padding: 6px 8px; font: 18px/20px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; } .info h4 { margin: 0 0 5px; color: #777; }
      .legend { text-align: left; line-height: 18px; color: #555; } .legend i { width: 18px; height: 18px; float: left; margin-right: 8px; opacity: 0.7; }
      .popupCustom .leaflet-popup-tip,
      .popupCustom .leaflet-popup-content-wrapper {
          background: #e0e0e0;
          color: #234c5e;
      }
    </style>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>


<body>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2">
                <h3> Contact for the FOCUS young scientists </h3>
                <div style="text-align:left; vertical-align: middle; ">
                    
                    <h4><i class="far fa-calendar-alt"></i></h4> 18 April 2018 &nbsp;
                    
                    
                    <h4><i class="fas fa-wrench"></i></h4> Leaflet, Javascript &nbsp;
                    
                    
                    
                    
                </div>
                <p>In April we had a very cool day of meeting and presentations among the young scientists of the <a href="https://www.focus.uliege.be">FOCUS</a> group. We were looking at an easy way to share the international contacts among all the members, for example when one wants to do a research exchange abroad.</p>

<h3 id="keep-it-simple">Keep it simple…</h3>

<p>Yes, we could have created a database with all the information, and then all the members could have filled the database, but it might look strange but even if we work with a lot of data, we’re not too keen on playing with databases. That probably deserves a post.</p>

<p>Our database will be a single file containing a list of entries, each of them looking like</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="trac"><code>"OGS",
[45.710678, 13.762393],
"Arthur Capet",
"http://www.ogs.trieste.it/en/",
["Physical oceanography", "Modelling"]
</code></pre></div></div>
<p>pretty explicit. So if someone can provide a new contact, the basic things we need to know are:</p>
<ul>
  <li>the name of the institute,</li>
  <li>the location (which can be found easily from the institute),</li>
  <li>the topics (a list), later used for filtering.</li>
</ul>

<p>I even think that the most tedious part could be related to the definition of the topics, because everybody has a different view on that, then in this prototype we use basic stuffs like “<em>Physical oceanography</em>”, “<em>Remote sensing</em>”, …</p>

<h3 id="implementation">Implementation</h3>

<p>A simple Leaflet map where all the contacts are represented as a marker. Two filters are offered:</p>
<ol>
  <li>The country, if someone is only interested in a given place. We use the library <code class="highlighter-rouge">Leaflet.CountrySelect.js</code>,</li>
  <li>The topic, as discussed before.</li>
</ol>

<p>Basically the usefulness of the tool will depend on the data providers, i.e. the scientists.</p>

<div id="map"></div>
<script type="text/javascript" src="../js/Leaflet.CountrySelect.js"></script>

<script src="../data/contacts.dat"></script>

<script>

  //var origin = [50.5887, 5.8699];
	var origin = L.latLng(50.5887, 5.8699);
	var map = L.map('map', {
		fullscreenControl: true,
	}).setView(origin, 4);

	L.marker(origin, {icon: L.AwesomeMarkers.icon({icon: 'home', prefix: 'fa', markerColor: 'red'}) }).addTo(map);

	map.addLayer(OpenStreetMap_Mapnik)

	var baseMaps = {
		"Esri OceanBasemap": Esri_OceanBasemap,
		"OpenStreetMap": OpenStreetMap_Mapnik,
		"Stamen Terrain": Stamen_Terrain,
	};

	var select = L.countrySelect({title:'Pick a country!'});

	var legend = L.control({position: 'topright'});
	legend.onAdd = function (map) {
	    var div = L.DomUtil.create('div', 'info legend');
	    div.innerHTML = `<select id="selectThematic" onchange=getThematic()>
			  <option>All disciplines</option>
				<option>Physical oceanography</option>
				<option>Chemical oceanography</option>
				<option>Modelling</option>
				<option>Remote sensing</option>
				<option>Morphology</option>
				</select>`;
	    div.firstChild.onmousedown = div.firstChild.ondblclick = L.DomEvent.stopPropagation;
	    return div;
	};
	legend.addTo(map);

	function getThematic(){
		var e = document.getElementById("selectThematic");
		var thematic = e.options[e.selectedIndex].value;
		console.log(thematic);
		addMarkers(thematic);
	};

	//info.addTo(map);

	function getColor(thematic){
		return thematic == "Physical oceanography" ? 'red' :
				 	 thematic == "Chemical oceanography" ? 'orange' :
				 	 thematic == "Modelling" ? 'green' :
				 	 thematic == "Remote sensing" ? 'blue' :
				   thematic == "Morphology" ? 'darkpurple' :
					 'darkred';
	}
	// Possible colors:
	// 'red', 'darkred', 'orange', 'green', 'darkgreen', 'blue', 'purple', 'darkpurple', 'cadetblue'

	var GeodesicOptions = {
		weight: 2,
		opacity: .7,
		color: 'blue',
		steps: 40,
	};

	var theLine = {};
	function onClick(e) {
		if (theLine != undefined) {
        map.removeLayer(theLine);
  	};
		theLine = L.geodesic([[origin, this.getLatLng()]], GeodesicOptions).addTo(map);
	}

	function formatPopup(contact) {
		textpopup = "<a href=" + contact[3] + ">" + contact[0] + "</a><br>" + "<i class='fa fa-envelope'></i> " + contact[2];
		return textpopup;
	};

	var customOptions =
    {
    'maxWidth': '400',
    'width': '200',
    'className' : 'popupCustom',
		'opacity' : .3,
    }

	var markers = L.markerClusterGroup();
	var ncontacts = contacts.length;

	// Initialise with all the markers
	getThematic("All disciplines");

	function addMarkers(thematic){
		// Remove the previous markers
		markers.clearLayers();
		for (var i = 0; i < ncontacts ; i++) {
			var themeList = contacts[i][4];
			if (themeList.indexOf(thematic) >= 0 || thematic === "All disciplines"){
				t = formatPopup(contacts[i]);
				cc = getColor(themeList[0]);
				console.log(cc);
				m = L.marker(contacts[i][1], {
					icon: L.AwesomeMarkers.icon({
						icon: 'info',
						prefix: 'fa',
						markerColor: cc
					})
				}).bindPopup(t, customOptions).on('click', onClick);
				markers.addLayers(m);
			}
		}
		map.addLayer(markers);
  }

	// Add country selector (not really useful)
	select.addTo(map);

	select.on('change', function(e){
		if (e.feature === undefined){ //Do nothing on title
			return;
		}
		var country = L.geoJson(e.feature);
		if (this.previousCountry != null){
			map.removeLayer(this.previousCountry);
		}
		this.previousCountry = country;

		map.addLayer(country);
		map.fitBounds(country.getBounds());

	});

	L.control.scale().addTo(map);
	L.control.layers(baseMaps, null, {autoZIndex:true, collapsed:false}).addTo(map);

</script>

<h3 id="afterthoughts">Afterthoughts</h3>

<p>Once again, let’s be honest: isn’t it an overkill to have an interactive map instead of a shared google spreadsheet? I would say that the map can be used for other purposes, for example showing the distribution and the numbers of contacts at a glance.</p>

<p>In addition, the time required to create the map was rather short, hence it’s not a big risk if it is not used often.</p>

<p>Finally, for the markers one could use the institute logo,</p>

            </div>
        </div>
    </div>
</body>

    <!-- Footer -->
    <footer class="text-center">
        <div class="footer-above">
            <div class="container">
                <div class="row">
                    <div class="footer-col col-md-3">

                        <p> <b><i class="fas fa-map-marker-alt"></i> </b>
                            
                                Verviers (Belgium) <br>
		                    
                        </p>
                    </div>
                    <div class="footer-col col-md-9">
                        <p><b>Credits</b>: <a href="https://github.com/jeromelachaud/freelancer-theme">Freelancer Jekyll theme</a> by jeromelachaud.<br> Freelancer is a free to use, open source Bootstrap theme created by <a href="http://startbootstrap.com">Start Bootstrap</a>.</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-below">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        Copyright &copy; Charles Troupin 2021
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
    <div class="scroll-top page-scroll visible-xs visible-sm">
        <a class="btn btn-primary" href="#page-top">
            <i class="fa fa-chevron-up"></i>
        </a>
    </div>

 <!-- jQuery Version 1.11.0 -->
    <script src="/js/jquery-1.11.0.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="/js/jquery.easing.min.js"></script>
    <script src="/js/classie.js"></script>
    <script src="/js/cbpAnimatedHeader.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="/js/jqBootstrapValidation.js"></script>
    
    <script src="/js/contact_me_static.js"></script>
    

    <!-- Custom Theme JavaScript -->
    <script src="/js/freelancer.js"></script>

</body>
